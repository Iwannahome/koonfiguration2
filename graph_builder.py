#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
from typing import Dict, List, Set, Tuple
# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
from repository import PackageRepository


# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
class DependencyGraph:
    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞
    """–ö–ª–∞—Å—Å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"""
    
    # –ú–µ—Ç–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–∞ (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä)
    def __init__(self, repository: PackageRepository):
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        
        Args:
            repository: –û–±—ä–µ–∫—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        """
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞
        self.repository = repository
        
        # –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ (–∫–ª—é—á=–ø–∞–∫–µ—Ç, –∑–Ω–∞—á–µ–Ω–∏–µ=—Å–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
        self.graph = {}
        
        # –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–µ—â—ë–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
        self.visited = set()
        
        # –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø—É—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–∏ (–¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–∏–∫–ª–æ–≤)
        self.current_path = set()
        
        # –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤
        self.cycles = []
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DFS
    def build_graph_dfs(self, package_name: str, depth: int = 0, max_depth: int = None) -> None:
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
        """
        –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DFS —Å —Ä–µ–∫—É—Ä—Å–∏–µ–π
        
        Args:
            package_name: –ò–º—è –ø–∞–∫–µ—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
            depth: –¢–µ–∫—É—â–∞—è –≥–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
            max_depth: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ (None = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
        """
        # –°–æ–∑–¥–∞—ë–º —Å—Ç—Ä–æ–∫—É –æ—Ç—Å—Ç—É–ø–∞, —É–º–Ω–æ–∂–∞—è "  " –Ω–∞ –≥–ª—É–±–∏–Ω—É —Ä–µ–∫—É—Ä—Å–∏–∏ (–¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞)
        indent = "  " * depth
        # –í—ã–≤–æ–¥–∏–º —Ç–µ–∫—É—â–∏–π –ø–∞–∫–µ—Ç —Å –æ—Ç—Å—Ç—É–ø–æ–º –∏ –≥–ª—É–±–∏–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏
        print(f"{indent}‚Üí –ê–Ω–∞–ª–∏–∑ –ø–∞–∫–µ—Ç–∞: {package_name} (–≥–ª—É–±–∏–Ω–∞: {depth})")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–¥–∞–Ω–∞ –ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞
        if max_depth is not None and depth >= max_depth:
            # –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è –≥–ª—É–±–∏–Ω–∞ >= –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π, –≤—ã–≤–æ–¥–∏–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            print(f"{indent}  ‚ö† –î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ {max_depth}")
            # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∏–∑ —Ä–µ–∫—É—Ä—Å–∏–∏)
            return
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —ç—Ç–æ—Ç –ø–∞–∫–µ—Ç —É–∂–µ –ø–æ—Å–µ—â—ë–Ω (–æ–±—Ä–∞–±–æ—Ç–∞–Ω)
        if package_name in self.visited:
            # –ï—Å–ª–∏ –±—ã–ª, –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º
            print(f"{indent}  ‚úì –ü–∞–∫–µ—Ç —É–∂–µ –ø–æ—Å–µ—â—ë–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
            return
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–∞–∫–µ—Ç –≤ —Ç–µ–∫—É—â–µ–º –ø—É—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–∏ (–ø—Ä–∏–∑–Ω–∞–∫ —Ü–∏–∫–ª–∞)
        if package_name in self.current_path:
            # –ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
            print(f"{indent}  üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ü–∏–∫–ª! {package_name} —É–∂–µ –≤ –ø—É—Ç–∏ –æ–±—Ö–æ–¥–∞")
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ–∫—É—â–µ–≥–æ –ø—É—Ç–∏ –≤ —Å–ø–∏—Å–æ–∫ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –ø–∞–∫–µ—Ç
            self.cycles.append(list(self.current_path) + [package_name])
            # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–µ –∏–¥—ë–º –¥–∞–ª—å—à–µ –≤–≥–ª—É–±—å)
            return
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –ø–∞–∫–µ—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—É—Ç–∏ (–æ—Ç–º–µ—á–∞–µ–º, —á—Ç–æ –º—ã —Å–µ–π—á–∞—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —ç—Ç—É –≤–µ—Ç–∫—É)
        self.current_path.add(package_name)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ç–µ–∫—É—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        dependencies = self.repository.get_dependencies(package_name)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–∞–∫–µ—Ç –≤ –≥—Ä–∞—Ñ —Å –µ–≥–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        self.graph[package_name] = dependencies
        
        # –í—ã–≤–æ–¥–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        print(f"{indent}  –ù–∞–π–¥–µ–Ω–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: {len(dependencies)}")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É —ç—Ç–æ–≥–æ –ø–∞–∫–µ—Ç–∞
        if dependencies:
            # –ï—Å–ª–∏ –µ—Å—Ç—å, –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
            for dep in dependencies:
                # –í—ã–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –æ—Ç—Å—Ç—É–ø–æ–º
                print(f"{indent}    - {dep}")
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ω–∞—á–∞–ª–æ –†–ï–ö–£–†–°–ò–ò)
        for dependency in dependencies:
            # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
            # depth + 1 —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≥–ª—É–±–∏–Ω—É –Ω–∞ 1
            # max_depth –ø–µ—Ä–µ–¥–∞—ë–º –¥–∞–ª—å—à–µ (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω)
            self.build_graph_dfs(dependency, depth + 1, max_depth)
        
        # –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —É–±–∏—Ä–∞–µ–º –ø–∞–∫–µ—Ç –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ø—É—Ç–∏
        # (–∑–∞–≤–µ—Ä—à–∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É —ç—Ç–æ–π –≤–µ—Ç–∫–∏ —Ä–µ–∫—É—Ä—Å–∏–∏)
        self.current_path.remove(package_name)
        
        # –û—Ç–º–µ—á–∞–µ–º –ø–∞–∫–µ—Ç –∫–∞–∫ –ø–æ—Å–µ—â—ë–Ω–Ω—ã–π (–ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞–±–æ—Ç–∞–Ω)
        self.visited.add(package_name)
        
        # –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–∞–∫–µ—Ç–∞
        print(f"{indent}‚úì –ó–∞–≤–µ—Ä—à—ë–Ω –∞–Ω–∞–ª–∏–∑: {package_name}")
    
    # –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞
    def get_graph(self) -> Dict[str, List[str]]:
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞
        """
        –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        
        Returns:
            Dict: –°–ª–æ–≤–∞—Ä—å —Å –≥—Ä–∞—Ñ–æ–º {–ø–∞–∫–µ—Ç: [–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏]}
        """
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –≥—Ä–∞—Ñ–∞
        return self.graph
    
    # –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤–∫–ª—é—á–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
    def get_all_dependencies(self, package_name: str) -> Set[str]:
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞
        """
        –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–∞–∫–µ—Ç–∞ (–≤–∫–ª—é—á–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
        
        Args:
            package_name: –ò–º—è –ø–∞–∫–µ—Ç–∞
            
        Returns:
            Set[str]: –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        """
        # –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        all_deps = set()
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–ª–æ–∂–µ–Ω–Ω—É—é (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é) —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ —Å–±–æ—Ä–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        def collect_deps(pkg: str):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–∞–∫–µ—Ç –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º –≥—Ä–∞—Ñ–µ
            if pkg in self.graph:
                # –ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è, –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
                for dep in self.graph[pkg]:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª–∞ –ª–∏ —ç—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ
                    if dep not in all_deps:
                        # –ï—Å–ª–∏ –Ω–µ –±—ã–ª–∞, –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ
                        all_deps.add(dep)
                        # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤—ã–∑—ã–≤–∞–µ–º collect_deps –¥–ª—è —ç—Ç–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
                        # (—á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –µ—ë –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
                        collect_deps(dep)
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–±–æ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –Ω–∞—á–∏–Ω–∞—è —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
        collect_deps(package_name)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–æ –≤—Å–µ–º–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
        return all_deps
    
    # –ú–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —Ü–∏–∫–ª–æ–≤ –≤ –≥—Ä–∞—Ñ–µ
    def has_cycles(self) -> bool:
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ü–∏–∫–ª–æ–≤ –≤ –≥—Ä–∞—Ñ–µ
        
        Returns:
            bool: True –µ—Å–ª–∏ –µ—Å—Ç—å —Ü–∏–∫–ª—ã, False –∏–Ω–∞—á–µ
        """
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º True –µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —Ü–∏–∫–ª–æ–≤ –Ω–µ –ø—É—Å—Ç–æ–π, –∏–Ω–∞—á–µ False
        return len(self.cycles) > 0
    
    # –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤
    def get_cycles(self) -> List[List[str]]:
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤
        
        Returns:
            List[List[str]]: –°–ø–∏—Å–æ–∫ —Ü–∏–∫–ª–æ–≤
        """
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ü–∏–∫–ª–æ–≤
        return self.cycles
    
    # –ú–µ—Ç–æ–¥ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≥—Ä–∞—Ñ–∞ –Ω–∞ —ç–∫—Ä–∞–Ω
    def print_graph(self) -> None:
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞
        """–í—ã–≤–µ—Å—Ç–∏ –≥—Ä–∞—Ñ –≤ —á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ"""
        # –í—ã–≤–æ–¥–∏–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –æ—Ç—Å—Ç—É–ø–∞
        print("\n" + "=" * 60)
        # –í—ã–≤–æ–¥–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        print("–ì–†–ê–§ –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô")
        # –í—ã–≤–æ–¥–∏–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
        print("=" * 60)
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É –ø–∞–∫–µ—Ç—É –≤ –≥—Ä–∞—Ñ–µ (sorted - —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ –∏–º–µ–Ω–∏)
        for package, dependencies in sorted(self.graph.items()):
            # –í—ã–≤–æ–¥–∏–º —ç–º–æ–¥–∑–∏ –ø–∞–∫–µ—Ç–∞ –∏ –µ–≥–æ –∏–º—è
            print(f"\nüì¶ {package}")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –ø–∞–∫–µ—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
            if dependencies:
                # –ï—Å–ª–∏ –µ—Å—Ç—å, –≤—ã–≤–æ–¥–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
                print(f"  ‚îî‚îÄ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ({len(dependencies)}):")
                # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
                for dep in dependencies:
                    # –í—ã–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –æ—Ç—Å—Ç—É–ø–æ–º
                    print(f"     ‚Ä¢ {dep}")
            else:
                # –ï—Å–ª–∏ –Ω–µ—Ç, –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º
                print("  ‚îî‚îÄ –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π")
        
        # –í—ã–≤–æ–¥–∏–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
        print("\n" + "=" * 60)
    
    # –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –≥—Ä–∞—Ñ—É
    def get_statistics(self) -> Dict:
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≥—Ä–∞—Ñ—É
        
        Returns:
            Dict: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        """
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤ –≤ –≥—Ä–∞—Ñ–µ
        total_packages = len(self.graph)
        
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π (—Å—É–º–º–∞ –¥–ª–∏–Ω –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
        total_edges = sum(len(deps) for deps in self.graph.values())
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∞–∫–µ—Ç–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º None (–ø–∞–∫–µ—Ç –µ—â—ë –Ω–µ –Ω–∞–π–¥–µ–Ω)
        max_deps_package = None
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 0 (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
        max_deps_count = 0
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É –ø–∞–∫–µ—Ç—É –∏ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º –≤ –≥—Ä–∞—Ñ–µ
        for package, deps in self.graph.items():
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±–æ–ª—å—à–µ –ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ç–µ–∫—É—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞, —á–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º
            if len(deps) > max_deps_count:
                # –ï—Å–ª–∏ –±–æ–ª—å—à–µ, –æ–±–Ω–æ–≤–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
                max_deps_count = len(deps)
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è –ø–∞–∫–µ—Ç–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
                max_deps_package = package
        
        # –°–æ–∑–¥–∞—ë–º —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–ª–∏—Å—Ç—å—è –≥—Ä–∞—Ñ–∞)
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≥—Ä–∞—Ñ—É –∏ –±–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç—ã —Å –ø—É—Å—Ç—ã–º —Å–ø–∏—Å–∫–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        leaf_packages = [pkg for pkg, deps in self.graph.items() if len(deps) == 0]
        
        # –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ
        return {
            # –ö–ª—é—á: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤, –∑–Ω–∞—á–µ–Ω–∏–µ: total_packages
            'total_packages': total_packages,
            # –ö–ª—é—á: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π, –∑–Ω–∞—á–µ–Ω–∏–µ: total_edges
            'total_edges': total_edges,
            # –ö–ª—é—á: –ø–∞–∫–µ—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
            'max_dependencies_package': max_deps_package,
            # –ö–ª—é—á: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
            'max_dependencies_count': max_deps_count,
            # –ö–ª—é—á: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
            'leaf_packages_count': len(leaf_packages),
            # –ö–ª—é—á: –µ—Å—Ç—å –ª–∏ —Ü–∏–∫–ª—ã (–≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ has_cycles)
            'has_cycles': self.has_cycles(),
            # –ö–ª—é—á: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏–∫–ª–æ–≤
            'cycles_count': len(self.cycles)
        }
